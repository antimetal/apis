// Antimetal API definitions
// Copyright Antimetal, Inc. All rights reserved.
//
// Use of this source code and APIs are governed by a source available license that can be found in
// the LICENSE file or at:
// https://polyformproject.org/wp-content/uploads/2020/06/PolyForm-Shield-1.0.0.txt

syntax = "proto3";

package antimetal.agent.v1;

import "antimetal/runtime/v1/linux.proto";

// SemanticVersion deconstructions the major, minor, and patch versions
// according to SemVer (https://semver.org)
message SemanticVersion {
  // semver major version
  uint32 major = 1;
  // semver minor version
  uint32 minor = 2;
  // semver patch version
  uint32 patch = 3;
}

// Build contains information about the Antimetal Agent build.
message Build {
  // version follows semver guidelines.
  SemanticVersion version = 1;
  // revision is the specific revision id that the build is based on (e.g. Git commit)
  string revision = 2;
}

// Instance identifies a running Antimetal Agent process.
message Instance {
  // id is generated by the Agent and presented to the management server.
  // The generated id should adhere to the following requirements:
  //
  //  - MUST be 16 bytes long
  //  - MUST be follow the UUID v7 spec
  //
  // The id SHOULD remain unchanged for the lifetime of the Agent process.
  bytes id = 1;

  // build used for the running Antimetal Agent process.
  Build build = 2;

  // linux_runtime contains Linux-specific runtime information including
  // system resources, kernel version, installed packages, and OS details.
  antimetal.runtime.v1.Linux linux_runtime = 3;

  // supported_collectors lists the data collection modules that this
  // agent instance supports. E.g. "sys.cpu", "sys.mem", etc.
  repeated string supported_collectors = 4;
}
